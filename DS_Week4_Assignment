-- Take-Home SQL Assignment


-- Q1: Total number of orders completed on 18th March 2023
SELECT COUNT(*) AS total_orders
FROM SALES
WHERE Date = '2023-03-18';

-- Q2: Total number of orders completed on 18th March 2023 by John Doe
SELECT COUNT(*) AS john_doe_orders
FROM SALES s
JOIN CUSTOMERS c ON s.Customer_id = c.Customer_id
WHERE s.Date = '2023-03-18'
  AND c.first_name = 'John'
  AND c.last_name = 'Doe';

-- Q3: List each customer who purchased in January 2023 and their average spending
SELECT 
  c.Customer_id, 
  c.first_name, 
  c.last_name, 
  AVG(s.Revenue) AS avg_revenue
FROM CUSTOMERS c 
JOIN SALES s ON c.Customer_id = s.Customer_id
WHERE s.Date BETWEEN '2023-01-01' AND '2023-01-31'
GROUP BY c.Customer_id, c.first_name, c.last_name;

-- Q4: Departments that generated less than $600 in 2022
SELECT i.department, SUM(s.Revenue) AS generated_amount
FROM ITEMS i 
JOIN SALES s ON i.Item_id = s.Item_id
WHERE s.Date BETWEEN '2022-01-01' AND '2022-12-31'
GROUP BY i.department
HAVING SUM(s.Revenue) < 600;

-- Q5: Most and least revenue generated by an order
SELECT 
  MAX(Revenue) AS max_revenue, 
  MIN(Revenue) AS min_revenue
FROM SALES;

-- Q6: Orders that were purchased in the most lucrative order
SELECT *
FROM SALES
WHERE Revenue = (SELECT MAX(Revenue) FROM SALES);
